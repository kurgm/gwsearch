{"mappings":"A,I,E,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,E,E,C,E,E,C,E,E,E,iB,A,O,I,A,C,E,S,C,E,G,K,E,O,C,C,E,C,O,C,G,K,E,C,I,E,C,C,E,A,Q,C,C,E,C,I,E,C,G,E,Q,C,C,E,O,C,C,E,C,E,E,I,C,E,O,C,E,E,O,E,E,O,A,C,I,E,A,M,uB,E,I,O,E,I,C,mB,C,C,E,Q,C,S,C,C,C,E,C,C,E,C,C,E,E,iB,C,G,A,C,E,E,Q,A,E,Q,S,C,C,C,E,O,c,C,E,O,C,W,C,I,W,O,C,E,I,S,C,E,O,E,C,E,W,C,E,a,C,C,GCEA,IAgBA,EAhBI,EAAU,IAAI,IAgBlB,EAfA,SAAkB,CAAO,CAAE,CAAQ,EACjC,IAAK,IAAI,EAAI,EAAG,EAAI,EAAS,MAAM,CAAG,EAAG,GAAK,EAC5C,EAAQ,GAAG,CAAC,CAAQ,CAAC,EAAE,CAAE,CACvB,QAAS,EACT,KAAM,CAAQ,CAAC,EAAI,EAAE,AACvB,EAEJ,C,GCVA,AAAA,EAAA,SAAA,QAAA,CAA8C,IAAA,IAAoB,GAAA,YAAA,GAAA,EAAI,QAAQ,GAAG,KAAK,KAAK,CAAC,iG,I,E,C,E,E,C,EGE5F,EAAiB,SAAU,CAAS,CAAE,CAAM,CAAE,CAAK,EACjD,GAAI,IAAW,KAAK,QAAQ,CAAC,MAAM,CAGjC,OAAO,EAGP,IAAI,EAAS,EAAQ,UAAY,KAAK,SAAS,CAAC,GAAa,IAAM,iBAAmB,KAAK,SAAS,CAAC,GAAa,KAClH,OAAO,IAAI,eAAe,CAAC,IAAI,KAAK,CAAC,EAAO,CAAE,CAC5C,KAAM,wBACR,GAEJ,EDbA,IAAI,EAAA,IAAA,IAA0B,sCAA9B,YAAA,GAAA,EACA,EAAiB,EAAU,EAAI,QAAQ,GAAI,EAAI,MAAM,CAAE,CAAA,GDIvD,SAAS,gBAAgB,CAAC,mBAAoB,KAC5C,IAAM,EAAsC,SAAS,cAAc,CAAC,eAC9D,EAAwC,SAAS,cAAc,CAAC,gBAChE,EAA0C,SAAS,cAAc,CAAC,UA2ClE,EAAS,IAAI,OAAnB,GAEM,EAAW,EAAE,CAoBnB,SAAS,EAAc,CAAG,EACxB,OAAO,IAAI,QAAQ,CAAC,EAAS,KAC3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","sources":["<anon>","node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-fc49b7114a4d9c2a.js","src/index.js","node_modules/@parcel/runtime-js/lib/runtime-ce1763b1c891b032.js","node_modules/@parcel/runtime-js/lib/helpers/get-worker-url.js"],"sourcesContent":["\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\n      var $parcel$global =\n        typeof globalThis !== 'undefined'\n          ? globalThis\n          : typeof self !== 'undefined'\n          ? self\n          : typeof window !== 'undefined'\n          ? window\n          : typeof global !== 'undefined'\n          ? global\n          : {};\n  \nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequire94c2\"];\n\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequire94c2\"] = parcelRequire;\n}\n\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"c1lIA\", function(module, exports) {\n\n$parcel$export(module.exports, \"register\", function () { return $8c066cc8bb362538$export$6503ec6e8aabbaf; }, function (v) { return $8c066cc8bb362538$export$6503ec6e8aabbaf = v; });\nvar $8c066cc8bb362538$export$6503ec6e8aabbaf;\nvar $8c066cc8bb362538$export$f7ad0328861e2f03;\n\"use strict\";\nvar $8c066cc8bb362538$var$mapping = new Map();\nfunction $8c066cc8bb362538$var$register(baseUrl, manifest) {\n    for(var i = 0; i < manifest.length - 1; i += 2)$8c066cc8bb362538$var$mapping.set(manifest[i], {\n        baseUrl: baseUrl,\n        path: manifest[i + 1]\n    });\n}\nfunction $8c066cc8bb362538$var$resolve(id) {\n    var resolved = $8c066cc8bb362538$var$mapping.get(id);\n    if (resolved == null) throw new Error('Could not resolve bundle with id ' + id);\n    return new URL(resolved.path, resolved.baseUrl).toString();\n}\n$8c066cc8bb362538$export$6503ec6e8aabbaf = $8c066cc8bb362538$var$register;\n$8c066cc8bb362538$export$f7ad0328861e2f03 = $8c066cc8bb362538$var$resolve;\n\n});\n\nvar $21cc6515704f46d6$exports = {};\n\n(parcelRequire(\"c1lIA\")).register(new URL(\"\", import.meta.url).toString(), JSON.parse(\"[\\\"ak0ox\\\",\\\"index.39a3694d.js\\\",\\\"dPT7b\\\",\\\"worker.945d4ff9.js\\\"]\"));\n\n/** @typedef {import(\"./worker.js\").Desc} Desc */ /** @typedef {import(\"./worker.js\").WRequest} WRequest */ /** @typedef {import(\"./worker.js\").WResponse} WResponse */ /** @typedef {import(\"./worker.js\").WorkerRequest} WorkerRequest */ /** @typedef {import(\"./worker.js\").WorkerResponse} WorkerResponse */ var $833bdadb5c274855$exports = {};\nvar $6b5924b6acbaee2a$exports = {};\n\"use strict\";\n$6b5924b6acbaee2a$exports = function(workerUrl, origin, isESM) {\n    if (origin === self.location.origin) // If the worker bundle's url is on the same origin as the document,\n    // use the worker bundle's own url.\n    return workerUrl;\n    else {\n        // Otherwise, create a blob URL which loads the worker bundle with `importScripts`.\n        var source = isESM ? 'import ' + JSON.stringify(workerUrl) + ';' : 'importScripts(' + JSON.stringify(workerUrl) + ');';\n        return URL.createObjectURL(new Blob([\n            source\n        ], {\n            type: 'application/javascript'\n        }));\n    }\n};\n\n\nlet $833bdadb5c274855$var$url = new URL(\"worker.945d4ff9.js\", import.meta.url);\n$833bdadb5c274855$exports = $6b5924b6acbaee2a$exports($833bdadb5c274855$var$url.toString(), $833bdadb5c274855$var$url.origin, true);\n\n\ndocument.addEventListener('DOMContentLoaded', ()=>{\n    const form = /** @type {HTMLFormElement} */ document.getElementById('search_form');\n    const input = /** @type {HTMLInputElement} */ document.getElementById('search_query');\n    const resultDiv = /** @type {HTMLDivElement} */ document.getElementById('result');\n    /** @param {string} queryStr */ function parseQuery(queryStr) {\n        /** @type {string[]} */ const query = [];\n        for(let tokenRe = /([a-z][a-z0-9_-]{4,})|&CDP-([\\dA-F]{4});|&_BS-UC-(\\d{4});|U\\+([\\dA-F]{1,6})|&#[Xx]([\\da-fA-F]+);|&#(\\d+);|(\\S)/gu, m; (m = tokenRe.exec(queryStr)) !== null;){\n            const [, glyphName, cdp, bsuc, codepoint0, hexCode, decCode, singleChar] = m;\n            if (glyphName) {\n                query.push(glyphName);\n                continue;\n            }\n            if (cdp) {\n                query.push(`abst:cdp-${cdp.toLowerCase()}`);\n                continue;\n            }\n            if (bsuc) {\n                query.push(`abst:_bs-uc-${bsuc}`);\n                continue;\n            }\n            /** @type {number} */ let codepoint;\n            if (codepoint0) codepoint = parseInt(codepoint0, 16);\n            else if (hexCode) codepoint = parseInt(hexCode, 16);\n            else if (decCode) codepoint = parseInt(decCode, 10);\n            else codepoint = singleChar.codePointAt(0);\n            query.push(`abst:u${codepoint.toString(16).padStart(4, '0')}`);\n        }\n        return query;\n    }\n    const worker = new Worker($833bdadb5c274855$exports);\n    /** @type {{ resolve: (dat: WResponse) => void; reject: (err: any) => void; }[]} */ const promises = [];\n    worker.addEventListener('message', (evt)=>{\n        if (!(evt.data instanceof Object)) return;\n        const res = /** @type {WorkerResponse} */ evt.data;\n        const promise = promises[res.id];\n        if (!promise) return;\n        if (\"error\" in res) {\n            promise.reject(res.error);\n            return;\n        }\n        promise.resolve(res);\n    });\n    /**\n   * @param {WRequest} req\n   * @returns {Promise<WResponse>}\n   */ function requestWorker(req) {\n        return new Promise((resolve, reject)=>{\n            const id = promises.push({\n                resolve: resolve,\n                reject: reject\n            }) - 1;\n            worker.postMessage(/** @type {WorkerRequest} */ {\n                ...req,\n                id: id\n            });\n        });\n    }\n    /**\n   * @param {string[]} query\n   * @returns {Promise<Desc[]>}\n   */ async function processQuery(query) {\n        const res = await requestWorker({\n            type: \"query\",\n            query: query\n        });\n        return /** @type {import('./worker.js').ProcessQueryResponse} */ res.value;\n    }\n    /**\n   * @param {string[]} items\n   * @returns {Promise<Desc[]>}\n   */ async function getChildren(items) {\n        const res = await requestWorker({\n            type: \"children\",\n            items: items\n        });\n        return /** @type {import('./worker.js').ChildrenResponse} */ res.value;\n    }\n    /** @type {string[] | null} */ let currentQuery = null;\n    /** @param {string} queryStr */ function doSearch(queryStr) {\n        const query = parseQuery(queryStr);\n        currentQuery = query;\n        processQuery(query).then((result)=>{\n            if (currentQuery !== query) return;\n            showResult(result);\n        }).catch((err)=>{\n            console.error(err);\n        });\n    }\n    form.addEventListener('submit', (evt)=>{\n        evt.preventDefault();\n        while(resultDiv.firstChild)resultDiv.removeChild(resultDiv.firstChild);\n        resultDiv.appendChild(document.createTextNode(\"(\\u691C\\u7D22\\u4E2D)\"));\n        const query = input.value;\n        doSearch(query);\n    });\n    /** @param {Desc[]} result */ function showResult(result) {\n        while(resultDiv.firstChild)resultDiv.removeChild(resultDiv.firstChild);\n        if (!result.length) {\n            resultDiv.appendChild(document.createTextNode(\"(\\u8A72\\u5F53\\u7D50\\u679C\\u306A\\u3057)\"));\n            return;\n        }\n        const resultUl = generateUl(result);\n        resultDiv.appendChild(resultUl);\n    }\n    /** @param {Desc[]} descs */ function generateUl(descs) {\n        const ul = document.createElement('ul');\n        for (const { names: names, children: children } of descs){\n            const li = document.createElement('li');\n            if (children.length) {\n                li.dataset.children = children.map((child)=>child[0]).join(',');\n                const btn = document.createElement('button');\n                btn.appendChild(document.createTextNode('+'));\n                li.appendChild(btn);\n            }\n            for (const [index, name] of names.entries()){\n                if (index !== 0) li.appendChild(document.createTextNode(' = '));\n                const node = generateRepresentationNode(name, index !== 0);\n                li.appendChild(node);\n            }\n            ul.appendChild(li);\n        }\n        return ul;\n    }\n    /**\n   * @param {string} name \n   * @param {boolean=} simpler\n   */ function generateRepresentationNode(name, simpler) {\n        if (name.startsWith('abst:')) {\n            let text = name.substring(5);\n            if (/^abst:cdp-[0-9a-f]{4}$/.test(name)) text = `&CDP-${name.substring(9).toUpperCase()};`;\n            else if (/^abst:u[0-9a-f]{4,}$/.test(name)) {\n                const codepointHex = name.substring(6);\n                const char = String.fromCodePoint(parseInt(codepointHex, 16));\n                text = `U+${codepointHex.toUpperCase()}: ${char}`;\n            } else if (/^abst:_bs-uc-\\d{4}$/.test(name)) text = `&_BS-UC-${name.substring(12)};`;\n            return document.createTextNode(text);\n        }\n        const link = document.createElement('a');\n        link.href = `https://glyphwiki.org/wiki/${name}`;\n        link.title = name;\n        if (!simpler) {\n            const img = document.createElement('img');\n            img.loading = 'lazy';\n            img.src = `https://glyphwiki.org/glyph/${name}.50px.png`;\n            img.alt = img.title = name;\n            img.className = 'thumb';\n            link.appendChild(img);\n        }\n        link.appendChild(document.createTextNode(name));\n        return link;\n    }\n    resultDiv.addEventListener('click', (evt)=>{\n        if (!(evt.target instanceof HTMLButtonElement && evt.target.parentNode instanceof HTMLLIElement && evt.target.parentNode.dataset.children)) return;\n        const btn = evt.target;\n        const li = evt.target.parentNode;\n        if (li.lastChild instanceof HTMLUListElement) {\n            btn.textContent = '+';\n            li.removeChild(li.lastChild);\n            return;\n        }\n        btn.disabled = true;\n        const items = li.dataset.children.split(',');\n        getChildren(items).then((children)=>{\n            if (!resultDiv.contains(li)) return;\n            const ul = generateUl(children);\n            btn.disabled = false;\n            btn.textContent = '-';\n            li.appendChild(ul);\n        });\n    });\n});\n\n\n//# sourceMappingURL=index.39a3694d.js.map\n","\"use strict\";\n\nvar mapping = new Map();\nfunction register(baseUrl, manifest) {\n  for (var i = 0; i < manifest.length - 1; i += 2) {\n    mapping.set(manifest[i], {\n      baseUrl: baseUrl,\n      path: manifest[i + 1]\n    });\n  }\n}\nfunction resolve(id) {\n  var resolved = mapping.get(id);\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n  return new URL(resolved.path, resolved.baseUrl).toString();\n}\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(new __parcel__URL__(\"\").toString(),JSON.parse(\"[\\\"ak0ox\\\",\\\"index.39a3694d.js\\\",\\\"dPT7b\\\",\\\"worker.945d4ff9.js\\\"]\"));","/** @typedef {import(\"./worker.js\").Desc} Desc */\n/** @typedef {import(\"./worker.js\").WRequest} WRequest */\n/** @typedef {import(\"./worker.js\").WResponse} WResponse */\n/** @typedef {import(\"./worker.js\").WorkerRequest} WorkerRequest */\n/** @typedef {import(\"./worker.js\").WorkerResponse} WorkerResponse */\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const form = /** @type {HTMLFormElement} */(document.getElementById('search_form'));\n  const input = /** @type {HTMLInputElement} */(document.getElementById('search_query'));\n  const resultDiv = /** @type {HTMLDivElement} */(document.getElementById('result'));\n\n  /** @param {string} queryStr */\n  function parseQuery(queryStr) {\n    /** @type {string[]} */\n    const query = [];\n    for (\n      let tokenRe =\n          /([a-z][a-z0-9_-]{4,})|&CDP-([\\dA-F]{4});|&_BS-UC-(\\d{4});|U\\+([\\dA-F]{1,6})|&#[Xx]([\\da-fA-F]+);|&#(\\d+);|(\\S)/gu,\n        m;\n      (m = tokenRe.exec(queryStr)) !== null;\n\n    ) {\n      const [, glyphName, cdp, bsuc, codepoint0, hexCode, decCode, singleChar] =\n        m;\n      if (glyphName) {\n        query.push(glyphName);\n        continue;\n      }\n      if (cdp) {\n        query.push(`abst:cdp-${cdp.toLowerCase()}`);\n        continue;\n      }\n      if (bsuc) {\n        query.push(`abst:_bs-uc-${bsuc}`);\n        continue;\n      }\n      /** @type {number} */\n      let codepoint;\n      if (codepoint0) {\n        codepoint = parseInt(codepoint0, 16);\n      } else if (hexCode) {\n        codepoint = parseInt(hexCode, 16);\n      } else if (decCode) {\n        codepoint = parseInt(decCode, 10);\n      } else {\n        codepoint = singleChar.codePointAt(0);\n      }\n      query.push(`abst:u${codepoint.toString(16).padStart(4, '0')}`);\n    }\n    return query;\n  }\n\n  const worker = new Worker(new URL('worker.js', import.meta.url), { type: 'module' });\n  /** @type {{ resolve: (dat: WResponse) => void; reject: (err: any) => void; }[]} */\n  const promises = [];\n  worker.addEventListener('message', (evt) => {\n    if (!(evt.data instanceof Object)) {\n      return;\n    }\n    const res = /** @type {WorkerResponse} */(evt.data);\n    const promise = promises[res.id];\n    if (!promise) {\n      return;\n    }\n    if (\"error\" in res) {\n      promise.reject(res.error);\n      return;\n    }\n    promise.resolve(res);\n  });\n  /**\n   * @param {WRequest} req\n   * @returns {Promise<WResponse>}\n   */\n  function requestWorker(req) {\n    return new Promise((resolve, reject) => {\n      const id = promises.push({ resolve, reject }) - 1;\n      worker.postMessage(/** @type {WorkerRequest} */({\n        ...req,\n        id,\n      }));\n    });\n  }\n\n  /**\n   * @param {string[]} query\n   * @returns {Promise<Desc[]>}\n   */\n  async function processQuery(query) {\n    const res = await requestWorker({\n      type: \"query\",\n      query,\n    });\n    return /** @type {import('./worker.js').ProcessQueryResponse} */(res).value;\n  }\n\n  /**\n   * @param {string[]} items\n   * @returns {Promise<Desc[]>}\n   */\n  async function getChildren(items) {\n    const res = await requestWorker({\n      type: \"children\",\n      items,\n    });\n    return /** @type {import('./worker.js').ChildrenResponse} */(res).value;\n  }\n\n  /** @type {string[] | null} */\n  let currentQuery = null;\n  /** @param {string} queryStr */\n  function doSearch(queryStr) {\n    const query = parseQuery(queryStr);\n    currentQuery = query;\n    processQuery(query)\n      .then((result) => {\n        if (currentQuery !== query) {\n          return;\n        }\n        showResult(result);\n      })\n      .catch((err) => {\n        console.error(err);\n      });\n  }\n\n  form.addEventListener('submit', (evt) => {\n    evt.preventDefault();\n\n    while (resultDiv.firstChild) {\n      resultDiv.removeChild(resultDiv.firstChild);\n    }\n    resultDiv.appendChild(document.createTextNode('(検索中)'));\n\n    const query = input.value;\n    doSearch(query);\n  });\n\n  /** @param {Desc[]} result */\n  function showResult(result) {\n    while (resultDiv.firstChild) {\n      resultDiv.removeChild(resultDiv.firstChild);\n    }\n    if (!result.length) {\n      resultDiv.appendChild(document.createTextNode('(該当結果なし)'));\n      return;\n    }\n    const resultUl = generateUl(result);\n    resultDiv.appendChild(resultUl);\n  }\n  /** @param {Desc[]} descs */\n  function generateUl(descs) {\n    const ul = document.createElement('ul');\n    for (const { names, children } of descs) {\n      const li = document.createElement('li');\n      if (children.length) {\n        li.dataset.children = children.map((child) => child[0]).join(',');\n        const btn = document.createElement('button');\n        btn.appendChild(document.createTextNode('+'));\n        li.appendChild(btn);\n      }\n      for (const [index, name] of names.entries()) {\n        if (index !== 0) {\n          li.appendChild(document.createTextNode(' = '));\n        }\n        const node = generateRepresentationNode(name, index !== 0);\n        li.appendChild(node);\n      }\n      ul.appendChild(li);\n    }\n    return ul;\n  }\n  /**\n   * @param {string} name \n   * @param {boolean=} simpler\n   */\n  function generateRepresentationNode(name, simpler) {\n    if (name.startsWith('abst:')) {\n      let text = name.substring('abst:'.length);\n      if (/^abst:cdp-[0-9a-f]{4}$/.test(name)) {\n        text = `&CDP-${name.substring('abst:cdp-'.length).toUpperCase()};`;\n      } else if (/^abst:u[0-9a-f]{4,}$/.test(name)) {\n        const codepointHex = name.substring('abst:u'.length);\n        const char = String.fromCodePoint(parseInt(codepointHex, 16));\n        text = `U+${codepointHex.toUpperCase()}: ${char}`\n      } else if (/^abst:_bs-uc-\\d{4}$/.test(name)) {\n        text = `&_BS-UC-${name.substring('abst:_bs-uc-'.length)};`;\n      }\n      return document.createTextNode(text);\n    }\n    const link = document.createElement('a');\n    link.href = `https://glyphwiki.org/wiki/${name}`;\n    link.title = name;\n    if (!simpler) {\n      const img = document.createElement('img');\n      img.loading = 'lazy';\n      img.src = `https://glyphwiki.org/glyph/${name}.50px.png`;\n      img.alt = img.title = name;\n      img.className = 'thumb';\n      link.appendChild(img);\n    }\n    link.appendChild(document.createTextNode(name));\n    return link;\n  }\n\n  resultDiv.addEventListener('click', (evt) => {\n    if (!(\n      evt.target instanceof HTMLButtonElement &&\n      evt.target.parentNode instanceof HTMLLIElement &&\n      evt.target.parentNode.dataset.children\n    )) {\n      return;\n    }\n    const btn = evt.target;\n    const li = evt.target.parentNode;\n    if (li.lastChild instanceof HTMLUListElement) {\n      btn.textContent = '+';\n      li.removeChild(li.lastChild);\n      return;\n    }\n    btn.disabled = true;\n    const items = li.dataset.children.split(',');\n    getChildren(items).then((children) => {\n      if (!resultDiv.contains(li)) {\n        return;\n      }\n      const ul = generateUl(children);\n      btn.disabled = false;\n      btn.textContent = '-';\n      li.appendChild(ul);\n    });\n  })\n});\n","let workerURL = require('./helpers/get-worker-url');\nlet url = new __parcel__URL__(\"worker.945d4ff9.js\");\nmodule.exports = workerURL(url.toString(), url.origin, true);","\"use strict\";\n\nmodule.exports = function (workerUrl, origin, isESM) {\n  if (origin === self.location.origin) {\n    // If the worker bundle's url is on the same origin as the document,\n    // use the worker bundle's own url.\n    return workerUrl;\n  } else {\n    // Otherwise, create a blob URL which loads the worker bundle with `importScripts`.\n    var source = isESM ? 'import ' + JSON.stringify(workerUrl) + ';' : 'importScripts(' + JSON.stringify(workerUrl) + ');';\n    return URL.createObjectURL(new Blob([source], {\n      type: 'application/javascript'\n    }));\n  }\n};"],"names":["$parcel$global","globalThis","self","window","global","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","parcelRegister","Object","defineProperty","get","$8c066cc8bb362538$export$6503ec6e8aabbaf","set","v","enumerable","configurable","$8c066cc8bb362538$var$mapping","Map","baseUrl","manifest","i","length","path","URL","url","toString","JSON","parse","$833bdadb5c274855$exports","$6b5924b6acbaee2a$exports","workerUrl","origin","isESM","location","source","stringify","createObjectURL","Blob","type","$833bdadb5c274855$var$url","document","addEventListener","form","getElementById","input","resultDiv","worker","Worker","promises","requestWorker","req","Promise","resolve","reject","push","postMessage","processQuery","query","res","value","getChildren","items","evt","data","promise","error","currentQuery","generateUl","descs","ul","createElement","names","children","li","dataset","map","child","join","btn","appendChild","createTextNode","index","name","entries","node","generateRepresentationNode","simpler","startsWith","text","substring","test","toUpperCase","codepointHex","char","String","fromCodePoint","parseInt","link","href","title","img","loading","src","alt","className","preventDefault","firstChild","removeChild","doSearch","queryStr","parseQuery","tokenRe","m","exec","codepoint","glyphName","cdp","bsuc","codepoint0","hexCode","decCode","singleChar","toLowerCase","codePointAt","padStart","then","result","showResult","resultUl","catch","console","target","HTMLButtonElement","parentNode","HTMLLIElement","lastChild","HTMLUListElement","textContent","disabled","split","contains"],"version":3,"file":"index.39a3694d.js.map"}